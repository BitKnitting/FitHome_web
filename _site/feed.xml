<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-07-03T09:47:25-07:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">FitHome</title><subtitle>Trim the Fat from your Electricity Bills.&lt;br&gt;Help Combat Climate Change.</subtitle><author><name>HappyDay</name></author><entry><title type="html"></title><link href="http://localhost:4000/2019/07/03/hw-and-fiw-Energy-Monitor.html" rel="alternate" type="text/html" title="" /><published>2019-07-03T00:00:00-07:00</published><updated>2019-07-03T00:00:00-07:00</updated><id>http://localhost:4000/2019/07/03/hw-and-fiw-Energy%20Monitor</id><content type="html" xml:base="http://localhost:4000/2019/07/03/hw-and-fiw-Energy-Monitor.html">&lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/post-entry-style.css&quot; /&gt;

&lt;h1 id=&quot;electricity-to-our-homes&quot;&gt;Electricity to our Homes&lt;/h1&gt;
&lt;h2 id=&quot;electricity-coming-into-our-homes&quot;&gt;Electricity Coming Into Our Homes&lt;/h2&gt;
&lt;p&gt;In our North American homes, 120V of electricity comes in through two power lines (HOT1 and HOT2).&lt;br /&gt;
 &lt;img src=&quot;/assets/post-imgs/post-2019-07-03/Power_wires_coming_into_house.png&quot; alt=&quot;power lines&quot; /&gt;&lt;br /&gt;
To measure the current, we use two Current Transformers (CTs), one for each power line.  To measure the voltage, we use readings from an AC power transformer plugged into our energy monitor.&lt;/p&gt;

&lt;h1 id=&quot;hardware&quot;&gt;Hardware&lt;/h1&gt;
&lt;h2 id=&quot;energy-monitor&quot;&gt;Energy Monitor&lt;/h2&gt;
&lt;p&gt;We are using Circuit Setup’s &lt;a href=&quot;https://circuitsetup.us/index.php/product/split-single-phase-real-time-whole-house-energy-meter-v1-2/&quot;&gt;Split Single Phase Real Time Whole House Energy Meter&lt;/a&gt; as the “brains” behind getting the readings from the home.&lt;br /&gt;
&lt;img src=&quot;/assets/post-imgs/post-2019-07-03/energy_meter1.jpg&quot; alt=&quot;energy meter&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;current-transformers&quot;&gt;Current Transformers&lt;/h3&gt;
&lt;p&gt;The electrician snaps one CurrentTransformer (CT) over each of the home’s two power lines.&lt;/p&gt;
&lt;h4 id=&quot;characteristics-of-the-ct&quot;&gt;Characteristics of the CT&lt;/h4&gt;
&lt;p&gt;The characteristics of a CT to be considered when sourcing include:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The amount of Amp Service.  &lt;a href=&quot;https://www.bhg.com/home-improvement/electrical/how-to-check-your-homes-electrical-capacity/&quot;&gt;From this article &lt;em&gt;Understanding Your Home’s Electrical Load&lt;/em&gt;&lt;/a&gt; &lt;em&gt;Different homes need different amp services. A 60-amp service is probably inadequate for a modern home. A 100-amp service is good for a home of less than 3,000 square feet that does not have central air-conditioning or electric heat. A home larger than 2,000 square feet that has central air-conditioning or electric heat probably needs a 200-amp service.&lt;/em&gt;  According to &lt;a href=&quot;https://community.openenergymonitor.org/t/ct-hole-diameter-for-north-america/5149&quot;&gt;Bill Thompson of the Open Energy Monitor Project&lt;/a&gt;, &lt;em&gt;US homes built before the late 60s were wired with Copper and typically had 100 Amp service, which used AWG 0 copper…Sometime in the late 60s to early 70s, Copper Service Entrance Wires were replaced by Aluminum. Since Aluminum has more resistance per foot than Copper, the equivalent Aluminum wire is two gauges larger than its Copper counterpart. About that same time, 200 Amp service became the norm.&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;The wire gauge.  The Outside Diameter of the wire gauge determines how large the diameter of the CT clamp must be.  As Bill noted, wires could be copper or aluminum, or copper-clad aluminum.  More aluminum, more current - the wider the diameter.
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://community.openenergymonitor.org/t/ct-hole-diameter-for-north-america/5149/3&quot;&gt;100 Amp Service uses 1/0 AWG&lt;/a&gt; = &lt;a href=&quot;https://lugsdirect.com/Wire_Insulation_Outside_Diameter_Thickness_600V.html&quot;&gt;12.08 mm&lt;/a&gt;.&lt;/li&gt;
      &lt;li&gt;200 Amp Service uses (up to?) 2/0 - 4/0 AWG.  &lt;a href=&quot;https://lugsdirect.com/Wire_Insulation_Outside_Diameter_Thickness_600V.html&quot;&gt;4/0 AWG has an Outside diameter of 16.04mm&lt;/a&gt;.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Whether the burden resistor is included.  This design assumes the CT &lt;strong&gt;does not&lt;/strong&gt; include the burden resistor.  I.e.: it’s output is a current and not a voltage.&lt;/li&gt;
  &lt;li&gt;The ratio of I(in) : I(out)&lt;/li&gt;
  &lt;li&gt;The inclusion of a zener diode.  This is a terrific safety measure to make sure when the CT is clamped on, there is on open current source.&lt;/li&gt;
&lt;/ul&gt;</content><author><name>HappyDay</name></author><summary type="html">Electricity to our Homes Electricity Coming Into Our Homes In our North American homes, 120V of electricity comes in through two power lines (HOT1 and HOT2). To measure the current, we use two Current Transformers (CTs), one for each power line. To measure the voltage, we use readings from an AC power transformer plugged into our energy monitor.</summary></entry><entry><title type="html"></title><link href="http://localhost:4000/2019/07/02/implementation-getting-started.html" rel="alternate" type="text/html" title="" /><published>2019-07-02T00:00:00-07:00</published><updated>2019-07-02T00:00:00-07:00</updated><id>http://localhost:4000/2019/07/02/implementation-getting-started</id><content type="html" xml:base="http://localhost:4000/2019/07/02/implementation-getting-started.html">&lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/post-entry-style.css&quot; /&gt;

&lt;p&gt;This post follows on the &lt;a href=&quot;/2019/06/30/design-getting-started.html&quot;&gt;Getting Started Design&lt;/a&gt; post.&lt;/p&gt;

&lt;h1 id=&quot;first-interaction&quot;&gt;First Interaction&lt;/h1&gt;
&lt;p&gt;The first interaction is with the Firebase RT db.  As noted in the design post, one of the steps we take to initiate the FitHome experience is to make a pre-member entry into the Firebase RT db.
&lt;img src=&quot;/assets/post-imgs/post-2019-6-30/pre-members-db.png&quot; alt=&quot;pre-member db entry&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We make this entry prior to the electrician installing the energy monitor.&lt;/p&gt;
&lt;h1 id=&quot;configuring-the-monitor&quot;&gt;Configuring the Monitor&lt;/h1&gt;
&lt;p&gt;The monitor needs two pieces of information:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The machine name.  This is configured “hard coded” into the firmware.  The machine name is a combination of a common name followed by a ‘-‘ and then the date.  For example, the machine name in the above image is &lt;code class=&quot;highlighter-rouge&quot;&gt;bambi-07012019&lt;/code&gt;. The common name is bambi and the date is 7/1/2019.&lt;/li&gt;
  &lt;li&gt;The SSID/password of the homeowner’s wifi.
Ideally, the SSID/password would magically vaporize into the energy monitor when the electrician plugs it in.  Unfortunately, it does not.
    &lt;h2 id=&quot;configuring-wifi&quot;&gt;Configuring wifi&lt;/h2&gt;
    &lt;p&gt;Soon after the electrician installs the energy monitor, the home owner must tell the energy monitor the home wifi SSID and password.  The technique to do this is starting the energy monitor’s firmware as a Local Access Point.  The homeowner goes to their mac or pc and scrolls the available wifi networks.  Once the energy monitor is plugged in, the network &lt;strong&gt;fithome&lt;/strong&gt; will be added. 
The home owner:&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;goes to their mac or pc.&lt;/li&gt;
  &lt;li&gt;opens the drop down list of wifi networks and chooses “fithome”.&lt;/li&gt;
  &lt;li&gt;uses “fithome” for the password.&lt;/li&gt;
  &lt;li&gt;opens a browser and types in the address &lt;code class=&quot;highlighter-rouge&quot;&gt;192.168.4.1&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;A web page is shown where the user picks their wifi SSID and enters the password.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After successful completion, the energy monitor is able to use the home’s wifi.&lt;/p&gt;
&lt;h1 id=&quot;sending-readings&quot;&gt;Sending Readings&lt;/h1&gt;
&lt;p&gt;Now that the energy monitor is online, it will start sending power readings to the Firebase RT db over wifi.  The energy monitor uses the Firebase REST APIs to send readings to the Firebase RT db.  An example curl command:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;curl -X POST -d '{&quot;P&quot;:1127.9}' \
  'https://&amp;lt;Firebase project name&amp;gt;.firebaseio.com/&amp;lt;machine name&amp;gt;/.json' 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;curl-to-http-post&quot;&gt;Curl to HTTP Post&lt;/h2&gt;
&lt;p&gt;The firmware uses HTTP.  I found this great web page that &lt;a href=&quot;https://curl.trillworks.com/&quot;&gt;converts curl commands to Python  &lt;/a&gt;.  VERY HELPFUL.&lt;/p&gt;
&lt;h2 id=&quot;example-post&quot;&gt;Example post&lt;/h2&gt;
&lt;p&gt;For example, this code would send the power value to the Firebaase RT db that is attached to the iot-test-1e426 project:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    def send_reading(self, v1, v2, i1, i2, power):
        do_connect(self.ssid, self.password)
        # .sv timestamp: http://bit.ly/2MO0XNt
        #data = '{'+'&quot;P&quot;:{},&quot;.sv&quot;:&quot;timestamp&quot;'.format(power) +'}'
        data = '{'+'&quot;P&quot;:{}'.format(power) +',&quot;timestamp&quot;: {&quot;.sv&quot;:&quot;timestamp&quot;}}'
        path = 'https://iot-test-1e426.firebaseio.com/'+self.device_name+'/'+self.userID+'/.json'
        print(path)
        response = requests.post(path, data=data)
        print('response: {}'.format(response.text))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The power reading is sent.  The “timestamp” is generated on the Firebase server then filled into the db entry.&lt;/p&gt;</content><author><name>HappyDay</name></author><summary type="html">This post follows on the Getting Started Design post.</summary></entry><entry><title type="html"></title><link href="http://localhost:4000/2019/06/30/design-getting-started.html" rel="alternate" type="text/html" title="" /><published>2019-06-30T00:00:00-07:00</published><updated>2019-06-30T00:00:00-07:00</updated><id>http://localhost:4000/2019/06/30/design-getting-started</id><content type="html" xml:base="http://localhost:4000/2019/06/30/design-getting-started.html">&lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/post-entry-style.css&quot; /&gt;

&lt;h1 id=&quot;design---getting-started&quot;&gt;Design - Getting Started&lt;/h1&gt;
&lt;p&gt;A homeowner finds out about FitHome from a post on NextDoor.  The post includes an email address to get started.
&lt;img src=&quot;/assets/post-imgs/post-2019-6-30/contact_through_monitoring.png&quot; alt=&quot;sketch image of getting started&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;1&quot;&gt;1&lt;/h1&gt;
&lt;p&gt;The homeowner either mails or sends a text to us.  We email/text back:&lt;/p&gt;

&lt;p&gt;1) a “contract” to sign that states the homeowner will commit to one month of FitHome Personal Electricity Savings Training.&lt;br /&gt;
2) a request for additional information, explaining why we need it:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;email address (used to create a membership)&lt;/li&gt;
  &lt;li&gt;home address (needed by the electrician to install the monitor)&lt;/li&gt;
  &lt;li&gt;contact phone/text number (needed to exchange info from us to the member)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3) letting them know an electrician will be contacting them to install the energy monitor.&lt;/p&gt;
&lt;h1 id=&quot;2&quot;&gt;2&lt;/h1&gt;
&lt;p&gt;We:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Assign an energy monitor to the homeowner.&lt;/li&gt;
  &lt;li&gt;Make a pre-member entry into the Firebase RT db.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/post-imgs/post-2019-6-30/pre-members-db.png&quot; alt=&quot;pre-member entry&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Contact the electrictian.  We give the electrician the homeowner’s address, contact info, and energy monitor.&lt;/li&gt;
  &lt;li&gt;We contact the homeowner to let them know an electrician will be contacting them.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;3&quot;&gt;3&lt;/h1&gt;
&lt;p&gt;The electrician:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Contacts the homeowner and arranges a date/time for an in-home visit to install the energy monitor in the homeowner’s circuit panel.&lt;/li&gt;
  &lt;li&gt;Installs the energy monitor.&lt;/li&gt;
  &lt;li&gt;Works with the homeowner to connect the energy monitor to the home’s wifi.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Once the energy monitor is installed and connected to the home’s wifi, it starts sending power readings to the Firebase RT db. One weeks worth of readings are taken prior to the start of the FitHome member’s 3 week personal training session.&lt;/p&gt;

&lt;h1 id=&quot;4&quot;&gt;4&lt;/h1&gt;
&lt;p&gt;The homeowner:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;(4.1) Installs and launches the FitHome app on their smartphone.&lt;/li&gt;
  &lt;li&gt;(4.2) Creates a Member account by entering their email and a password.  &lt;em&gt;Note: The email must be the same email given to us earlier.&lt;/em&gt;&lt;/li&gt;
  &lt;li&gt;(4.3) Verifies the homeowner is getting data on their app by viewing the impact screen.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;During this time, the app shows the Impact Screen.  However, the Analysis and Leaderboard screen aren’t available.  They show a countdown of how much time is left before their FitHome session begins.   By starting with a week’s worth of data, we can personalize electricity savings advice based on how they currently use electricity.&lt;/p&gt;</content><author><name>HappyDay</name></author><summary type="html">Design - Getting Started A homeowner finds out about FitHome from a post on NextDoor. The post includes an email address to get started.</summary></entry></feed>